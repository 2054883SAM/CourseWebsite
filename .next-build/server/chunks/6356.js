"use strict";exports.id=6356,exports.ids=[6356],exports.modules={20444:(e,t,r)=>{r.d(t,{A:()=>o});var a=r(60687),i=r(43210),s=r(72600),l=r(49764),n=r(57958);let o=(0,i.memo)(function({videoId:e,watermark:t,className:r,chapters:o=[],userId:d,courseId:c,duration:u,onChapterSeek:m,onProgress:h,onComplete:p,onChapterComplete:x}){let f=(0,i.useRef)(null);(0,i.useRef)(!1),(0,i.useRef)(!1);let[g,y]=(0,i.useState)(null),[b,v]=(0,i.useState)(0),[j,w]=(0,i.useState)(!1),k=(0,n.UQ)(o);(0,i.useRef)(0),(0,i.useRef)(-1),(0,i.useRef)(!1);let N=(0,i.useRef)(!1);(0,i.useRef)(new Set);let T=g?(0,a.jsx)("iframe",{ref:f,src:g,width:"100%",height:"100%",style:{aspectRatio:"16 / 9",border:"none"},allowFullScreen:!0,allow:"encrypted-media",sandbox:"allow-scripts allow-same-origin allow-presentation allow-popups"},`player-${e}`):(0,a.jsx)("div",{className:"flex aspect-video w-full items-center justify-center text-gray-500",children:"Loading secure video..."});return(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,a.jsx)(s.default,{src:"https://player.vdocipher.com/v2/api.js",strategy:"afterInteractive"}),(0,a.jsx)("div",{className:"col-span-1 md:col-span-2",children:(0,a.jsx)("div",{className:r,children:T})}),k&&k.length>0&&(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)(l.A,{chapters:k,currentTime:b,onChapterClick:e=>{w(!0);try{if(f.current&&window.VdoPlayer){console.log(`Seeking to chapter at time: ${e.startTime}`);let t=f.current;if(!t)throw Error("Iframe element is null");let r=window.VdoPlayer.getInstance(t);r.video.currentTime=e.startTime,r.video.play(),v(e.startTime),m&&m(e,e.startTime),setTimeout(()=>{w(!1)},1e3)}else console.error("Player iframe not available for seeking or VdoPlayer API not loaded"),w(!1)}catch(e){console.error("Error seeking to chapter:",e),w(!1)}},isLoading:j,onFinish:()=>{try{if(f.current&&window.VdoPlayer){let e=f.current,t=window.VdoPlayer.getInstance(e),r=t.video?.duration||u||0;if(r>0){let e=Math.max(r-.05,0);if(t.video.currentTime=e,t.video.play?.(),"function"==typeof h)try{h(100)}catch{}if(!N.current&&"function"==typeof p){N.current=!0;try{p()}catch{}}d&&c&&fetch("/api/courses/progress/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d,courseId:c,progress:100})}).catch(()=>{})}}}catch(e){console.warn("Could not jump to end:",e)}}})})]})},(e,t)=>{let r=e.videoId===t.videoId,a=e.watermark===t.watermark,i=e.onChapterSeek===t.onChapterSeek,s=!e.chapters&&!t.chapters||Array.isArray(e.chapters)&&Array.isArray(t.chapters)&&e.chapters.length===t.chapters.length;return r&&a&&s&&i})},46055:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var a=r(31658);let i=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},49764:(e,t,r)=>{r.d(t,{A:()=>n});var a=r(60687);r(43210);var i=r(57958);let s=e=>{let t=Math.floor(e/60),r=Math.floor(e%60);return`${t}:${r.toString().padStart(2,"0")}`},l=(e,t)=>{let r=[...e].sort((e,t)=>e.startTime-t.startTime);for(let e=r.length-1;e>=0;e--)if(t>=r[e].startTime)return r[e].id;return r[0]?.id||null},n=({chapters:e,currentTime:t,onChapterClick:r,className:n="",isLoading:o=!1,onFinish:d})=>{let c=(0,i.UQ)(e);if(!c||0===c.length)return(0,a.jsx)("div",{className:`p-4 text-center text-gray-500 ${n}`,children:(0,a.jsx)("p",{children:"No chapters available"})});let u=l(c,t);return(0,a.jsxs)("div",{className:`bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg ${n}`,children:[(0,a.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),"Chapitres"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[e.length," chapitre",1!==e.length?"s":""]}),(0,a.jsx)("div",{className:"mt-3 flex justify-end",children:(0,a.jsx)("button",{type:"button",className:"rounded bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white hover:bg-indigo-700 disabled:opacity-50",onClick:()=>d&&d(),disabled:!!o,title:"Mark video as finished and jump near the end",children:"Termin\xe9"})})]}),(0,a.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:c.map((e,t)=>{let i=e.id===u;return(0,a.jsx)("div",{"data-testid":`chapter-${e.id}`,className:`
                transition-colors duration-200
                ${i?"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500":"hover:bg-gray-50 dark:hover:bg-gray-700/50"}
              `,children:(0,a.jsxs)("button",{"data-testid":`chapter-button-${e.id}`,onClick:()=>r(e),disabled:o,className:`w-full p-4 text-left focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset ${o?"opacity-50 cursor-not-allowed":""}`,"aria-label":`Chapter ${t+1}: ${e.title}`,children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center mb-1",children:[(0,a.jsx)("span",{className:"flex-shrink-0 w-6 h-6 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs font-medium rounded-full flex items-center justify-center mr-3",children:t+1}),(0,a.jsx)("h4",{className:`text-sm font-medium truncate ${i?"text-blue-700 dark:text-blue-300":"text-gray-900 dark:text-white"}`,children:e.title}),!0===e.flashcard&&(0,a.jsx)("span",{className:"ml-2 inline-flex items-center",title:"Flashcard available","aria-label":"Flashcard available",children:(0,a.jsx)("svg",{className:"w-4 h-4 text-yellow-500",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:(0,a.jsx)("path",{d:"M12 2l2.39 4.84 5.34.78-3.86 3.76.91 5.32L12 14.77 6.22 16.7l.91-5.32-3.86-3.76 5.34-.78L12 2z"})})})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 ml-9",children:e.description})]}),(0,a.jsxs)("div",{className:"flex-shrink-0 ml-4 text-right",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:s(e.startTime)}),e.duration&&(0,a.jsx)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:s(e.duration+e.startTime)})]})]}),i&&(0,a.jsxs)("div",{className:"flex items-center mt-2 ml-9",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse mr-2"}),(0,a.jsx)("span",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:"En cours"})]})]})},e.id)})})]})}},57958:(e,t,r)=>{function a(e){return{id:e.id,title:e.title,startTime:e.start_time,duration:e.duration,description:e.description,thumbnail:e.thumbnail_url}}function i(e){return!!e&&"object"==typeof e&&"string"==typeof e.id&&"string"==typeof e.title&&"number"==typeof e.start_time&&(void 0===e.duration||"number"==typeof e.duration)&&(void 0===e.description||"string"==typeof e.description)&&(void 0===e.thumbnail_url||"string"==typeof e.thumbnail_url)}function s(e){return!!e&&"object"==typeof e&&"string"==typeof e.id&&"string"==typeof e.title&&"number"==typeof e.startTime&&(void 0===e.duration||"number"==typeof e.duration)&&(void 0===e.description||"string"==typeof e.description)&&(void 0===e.thumbnail||"string"==typeof e.thumbnail)&&(void 0===e.flashcard||"boolean"==typeof e.flashcard)}function l(e){try{let t=e;if("string"==typeof t&&(t=JSON.parse(t)),!Array.isArray(t))return[];if(t.every(s))return t;if(t.every(i))return t.map(a);let r=[];for(let e of t)s(e)?r.push(e):i(e)&&r.push(a(e));return r}catch(e){return[]}}r.d(t,{UQ:()=>l})}};