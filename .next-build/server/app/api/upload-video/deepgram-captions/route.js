(()=>{var e={};e.id=5323,e.ids=[5323],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10081:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>f});var n={};r.r(n),r.d(n,{OPTIONS:()=>h,POST:()=>c});var s=r(96559),i=r(48088),o=r(37719),a=r(32190),u=r(17448),l=r(28086);async function c(e){try{let t,n;console.log("[Deepgram Captions] Received request");let s=e.headers.get("content-type")||"";console.log("[Deepgram Captions] Content-Type:",s);let i=function(){let e=process.env.DEEPGRAM_API_KEY;if(!e)throw Error("DEEPGRAM_API_KEY environment variable is not set");return(0,u.createClient)(e)}();console.log("[Deepgram Captions] Client created. API key present:",!!process.env.DEEPGRAM_API_KEY);let o="vtt";if(!s.includes("multipart/form-data"))return console.warn("[Deepgram Captions] Unsupported content-type. Expected multipart/form-data with file."),a.NextResponse.json({error:"Use multipart/form-data with file"},{status:400});console.log("[Deepgram Captions] Using multipart/form-data (file) mode");let c=await e.formData(),h=c.get("file"),d=c.get("format")||"vtt",p=c.get("language")||void 0,f=c.get("courseId")||void 0,g=c.get("sectionId")||void 0,v=c.get("videoId")||void 0;if(o="srt"===d?"srt":"vtt",console.log("[Deepgram Captions] multipart inputs:",{hasFile:!!h,fileType:h?.type,fileSize:h?`${h.size} bytes`:"n/a",format:o,language:p,courseId:f,sectionId:g,videoId:v}),!h)return a.NextResponse.json({error:"Missing file"},{status:400});let y=await h.arrayBuffer(),m=Buffer.from(y);console.log("[Deepgram Captions] Input buffer size:",m.length,"type:",h.type,"name:",h.name);let w={smart_format:!0,utterances:!0};p&&"string"==typeof p&&(w.language=p),console.log("[Deepgram Captions] TranscribeFile options:",w);let{result:b,error:S}=await i.listen.prerecorded.transcribeFile(m,w);if(S)return console.error("[Deepgram Captions] transcribeFile error:",S),a.NextResponse.json({error:String(S)},{status:500});let j=b?.results?.utterances?.length||0;console.log("[Deepgram Captions] transcribeFile success. utterances:",j),console.log("[Deepgram Captions] Transcription received. Building captions as",o);let C=await Promise.resolve().then(r.bind(r,17448));try{t="vtt"===o?C.webvtt(b):C.srt(b)}catch(r){console.warn("[Deepgram Captions] Helper conversion failed, attempting fallback from utterances. Error:",r);let e=b?.results?.utterances;if(!Array.isArray(e)||!(e.length>0))return console.error("[Deepgram Captions] No utterances present in transcript. keys:",Object.keys(b||{})),a.NextResponse.json({error:"Transcript missing utterances; cannot build captions."},{status:500});{let r=e=>{let t=Math.max(0,Math.floor(1e3*e)),r=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4),s=Math.floor(t%6e4/1e3),i=(e,t=2)=>String(e).padStart(t,"0");return`${i(r)}:${i(n)}:${i(s)}.${String(t%1e3).padStart(3,"0")}`};t="vtt"===o?"WEBVTT\n\n"+e.map(e=>`${r(e.start)} --> ${r(e.end)}
${(e.transcript||"").trim()}
`).join("\n"):e.map((e,t)=>{let n=e=>r(e).replace(".",",");return`${t+1}
${n(e.start)} --> ${n(e.end)}
${(e.transcript||"").trim()}
`}).join("\n")}}if(console.log("[Deepgram Captions] Captions length:",t?.length),t&&"vtt"===o&&f)try{let e=await (0,l.t)(),r=g?`${g}/captions.vtt`:void 0;r||console.warn("[Deepgram Captions] Missing sectionId; cannot store section-scoped captions");let s=new Blob([t],{type:"text/vtt"});if(r){let{error:t}=await e.storage.from("translations").upload(r,s,{upsert:!0,contentType:"text/vtt"});t?console.warn("[Deepgram Captions] Storage upload failed:",t.message):(n=r,console.log("[Deepgram Captions] Stored captions at",r))}}catch(e){console.warn("[Deepgram Captions] Error storing captions to Supabase:",e)}if(t&&"vtt"===o&&p&&v)try{let e=process.env.VDO_API_SECRET;if(e){let r=new FormData,n=new File([t],"captions.vtt",{type:"text/vtt"});r.append("file",n);let s=`https://dev.vdocipher.com/api/videos/${encodeURIComponent(v)}/files?language=${encodeURIComponent(p)}`;console.log("[Deepgram Captions] Uploading original captions to VdoCipher",{url:s});let i=await fetch(s,{method:"POST",headers:{Authorization:`Apisecret ${e}`},body:r});if(i.ok)console.log("[Deepgram Captions] VdoCipher upload success");else{let e=await i.text();console.warn("[Deepgram Captions] VdoCipher upload failed",i.status,e)}}else console.error("[Deepgram Captions] Missing VDO_API_SECRET; skipping VdoCipher upload")}catch(e){console.warn("[Deepgram Captions] Error uploading original captions to VdoCipher:",e)}return a.NextResponse.json({captions:t,format:o,storedPath:n},{status:200})}catch(e){return console.error("[Deepgram Captions] Unexpected error:",e),a.NextResponse.json({error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function h(){return a.NextResponse.json({},{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,OPTIONS"}})}let d=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/upload-video/deepgram-captions/route",pathname:"/api/upload-video/deepgram-captions",filename:"route",bundlePath:"app/api/upload-video/deepgram-captions/route"},resolvedPagePath:"C:\\Users\\Konan\\Documents\\MONSPACE\\CourseWebsite-1\\app\\api\\upload-video\\deepgram-captions\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:p,workUnitAsyncStorage:f,serverHooks:g}=d;function v(){return(0,o.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:f})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},17448:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AbstractClient:()=>K,AbstractLiveClient:()=>es,AbstractRestClient:()=>et,AbstractRestfulClient:()=>et,AbstractWsClient:()=>es,AgentEvents:()=>p,AgentLiveClient:()=>ej,AuthRestClient:()=>er,CONNECTION_STATE:()=>c,CallbackUrl:()=>q,DEFAULT_AGENT_OPTIONS:()=>W,DEFAULT_AGENT_URL:()=>F,DEFAULT_GLOBAL_OPTIONS:()=>z,DEFAULT_HEADERS:()=>J,DEFAULT_OPTIONS:()=>Y,DEFAULT_URL:()=>B,Deepgram:()=>eR,DeepgramApiError:()=>i,DeepgramClient:()=>eC,DeepgramError:()=>n,DeepgramUnknownError:()=>o,DeepgramVersionError:()=>a,DeepgramWebSocketError:()=>u,ListenClient:()=>el,ListenLiveClient:()=>eo,ListenRestClient:()=>eu,LiveClient:()=>eo,LiveConnectionState:()=>f,LiveTTSEvents:()=>d,LiveTranscriptionEvents:()=>h,ManageClient:()=>eh,ManageRestClient:()=>eh,ModelsRestClient:()=>ep,OnPremClient:()=>eg,PrerecordedClient:()=>eu,ReadClient:()=>ey,ReadRestClient:()=>ey,SOCKET_STATES:()=>l,SelfHostedRestClient:()=>eg,SpeakClient:()=>eS,SpeakLiveClient:()=>em,SpeakRestClient:()=>eb,appendSearchParams:()=>E,applyDefaults:()=>U,buildRequestUrl:()=>P,convertLegacyOptions:()=>L,convertProtocolToWs:()=>A,createClient:()=>eI,isDeepgramClientOptions:()=>_,isDeepgramError:()=>s,isFileSource:()=>T,isLiveSchema:()=>N,isTextSource:()=>M,isUrlSource:()=>D,noop:()=>G,resolveHeadersConstructor:()=>x,srt:()=>eT,stripTrailingSlash:()=>$,webvtt:()=>eM});class n extends Error{constructor(e){super(e),this.__dgError=!0,this.name="DeepgramError"}}function s(e){return"object"==typeof e&&null!==e&&"__dgError"in e}class i extends n{constructor(e,t){super(e),this.name="DeepgramApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class o extends n{constructor(e,t){super(e),this.name="DeepgramUnknownError",this.originalError=t}}class a extends n{constructor(){super("You are attempting to use an old format for a newer SDK version. Read more here: https://dpgr.am/js-v3"),this.name="DeepgramVersionError"}}class u extends n{constructor(e,t={}){super(e),this.name="DeepgramWebSocketError",this.originalEvent=t.originalEvent,this.statusCode=t.statusCode,this.requestId=t.requestId,this.responseHeaders=t.responseHeaders,this.url=t.url,this.readyState=t.readyState}toJSON(){return{name:this.name,message:this.message,statusCode:this.statusCode,requestId:this.requestId,responseHeaders:this.responseHeaders,url:this.url,readyState:this.readyState,originalEvent:this.originalEvent?{type:this.originalEvent.type,timeStamp:this.originalEvent.timeStamp}:void 0}}}var l,c,h,d,p,f,g=r(94735),v=r(91272),y=r.n(v),m=r(43793),w=r.n(m);let b="undefined"!=typeof process&&process.versions&&process.versions.node?process.versions.node:"unknown",S="undefined"!=typeof process&&process.versions&&process.versions.bun?process.versions.bun:"unknown",j="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"unknown",C=()=>"unknown"!==j,O=()=>"unknown"!==b,k=()=>"unknown"!==S;function $(e){return e.replace(/\/$/,"")}function U(e={},t={}){return w()(t,e)}function E(e,t){Object.keys(t).forEach(r=>{Array.isArray(t[r])?t[r].forEach(t=>{e.append(r,String(t))}):e.append(r,String(t[r]))})}let x=()=>"undefined"==typeof Headers?v.Headers:Headers,D=e=>!!e&&!!e.url,M=e=>!!e&&!!e.text,T=e=>!!(I(e)||R(e)),R=e=>null!=e&&Buffer.isBuffer(e),I=e=>!(null==e||C())&&"object"==typeof e&&"function"==typeof e.pipe&&"function"==typeof e.read&&"object"==typeof e._readableState;class q extends URL{constructor(){super(...arguments),this.callbackUrl=!0}}let A=e=>e.toLowerCase().replace(/^http/,"ws"),P=(e,t,r)=>{let n=new URL(e,t);return E(n.searchParams,r),n};function N(e){return null!=e&&void 0!==e.interim_results}function _(e){return null!=e&&void 0!==e.global}let L=e=>{var t,r,n,s,i,o;let a={};return e._experimentalCustomFetch&&(a.global={fetch:{client:e._experimentalCustomFetch}}),(null==(t=(e=w()(e,a)).restProxy)?void 0:t.url)&&(a.global={fetch:{options:{proxy:{url:null==(r=e.restProxy)?void 0:r.url}}}}),(null==(n=(e=w()(e,a)).global)?void 0:n.url)&&(a.global={fetch:{options:{url:e.global.url}},websocket:{options:{url:e.global.url}}}),(null==(s=(e=w()(e,a)).global)?void 0:s.headers)&&(a.global={fetch:{options:{headers:null==(i=e.global)?void 0:i.headers}},websocket:{options:{_nodeOnlyHeaders:null==(o=e.global)?void 0:o.headers}}}),e=w()(e,a)},H="4.11.2",J={"Content-Type":"application/json","X-Client-Info":`@deepgram/sdk; ${C()?"browser":"server"}; v${H}`,"User-Agent":`@deepgram/sdk/${H} ${O()?`node/${b}`:k()?`bun/${S}`:C()?`javascript ${j}`:"unknown"}`},B="https://api.deepgram.com",F="wss://agent.deepgram.com",z={fetch:{options:{url:B,headers:J}},websocket:{options:{url:A(B),_nodeOnlyHeaders:J}}},W={fetch:{options:{url:B,headers:J}},websocket:{options:{url:F,_nodeOnlyHeaders:J}}},Y={global:z,agent:W};!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(l||(l={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(c||(c={}));let G=()=>{};class K extends g.EventEmitter{constructor(e){if(super(),this.factory=void 0,this.key=void 0,this.accessToken=void 0,this.namespace="global",this.version="v1",this.baseUrl=B,this.logger=G,"function"==typeof e.accessToken?(this.factory=e.accessToken,this.accessToken=this.factory()):this.accessToken=e.accessToken,"function"==typeof e.key?(this.factory=e.key,this.key=this.factory()):this.key=e.key,this.key||this.accessToken||(this.accessToken=process.env.DEEPGRAM_ACCESS_TOKEN,this.accessToken||(this.key=process.env.DEEPGRAM_API_KEY)),!this.key&&!this.accessToken)throw new n("A deepgram API key or access token is required.");e=L(e),this.options=U(e,Y)}v(e="v1"){return this.version=e,this}get namespaceOptions(){return Object.assign(Object.assign({},U(this.options[this.namespace],this.options.global)),{key:this.key})}getRequestUrl(e,t={version:this.version},r){t.version=this.version;let n=new URL(e=e.replace(/:(\w+)/g,function(e,r){return t[r]}),this.baseUrl);return r&&E(n.searchParams,r),n}log(e,t,r){this.logger(e,t,r)}}var V=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};let Z=e=>{let t;return t=e||("undefined"==typeof fetch?y():fetch),(...e)=>t(...e)},X=({apiKey:e,customFetch:t,accessToken:r})=>{let n=Z(t),s=x();return(t,i)=>V(void 0,void 0,void 0,function*(){let o=new s(null==i?void 0:i.headers);return o.has("Authorization")||o.set("Authorization",r?`Bearer ${r}`:`Token ${e}`),n(t,Object.assign(Object.assign({},i),{headers:o}))})},Q=()=>V(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.t.bind(r,91272,23))).Response:Response});var ee=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};class et extends K{constructor(e){if(super(e),C()&&!this.proxy)throw new n("Due to CORS we are unable to support REST-based API calls to our API from the browser. Please consider using a proxy: https://dpgr.am/js-proxy for more information.");let{accessToken:t,key:r,fetch:s}=this;this.fetch=X({accessToken:t,apiKey:r,customFetch:s}),this.proxy?this.baseUrl=this.namespaceOptions.fetch.options.proxy.url:this.baseUrl=this.namespaceOptions.fetch.options.url}_getErrorMessage(e){return e.msg||e.message||e.error_description||e.error||JSON.stringify(e)}_handleError(e,t){return ee(this,void 0,void 0,function*(){e instanceof(yield Q())?e.json().then(r=>{t(new i(this._getErrorMessage(r),e.status||500))}).catch(e=>{t(new o(this._getErrorMessage(e),e))}):t(new o(this._getErrorMessage(e),e))})}_getRequestOptions(e,t,r){let n={method:e};return n="GET"===e||"DELETE"===e?Object.assign(Object.assign({},n),t):Object.assign(Object.assign({duplex:"half",body:t},n),r),w()(this.namespaceOptions.fetch.options,n,{clone:!1})}_handleRequest(e,t,r,n){return ee(this,void 0,void 0,function*(){return new Promise((s,i)=>{(0,this.fetch)(t,this._getRequestOptions(e,r,n)).then(e=>{if(!e.ok)throw e;s(e)}).catch(e=>this._handleError(e,i))})})}get(e,t){return ee(this,void 0,void 0,function*(){return this._handleRequest("GET",e,t)})}post(e,t,r){return ee(this,void 0,void 0,function*(){return this._handleRequest("POST",e,t,r)})}put(e,t,r){return ee(this,void 0,void 0,function*(){return this._handleRequest("PUT",e,t,r)})}patch(e,t,r){return ee(this,void 0,void 0,function*(){return this._handleRequest("PATCH",e,t,r)})}delete(e,t){return ee(this,void 0,void 0,function*(){return this._handleRequest("DELETE",e,t)})}get proxy(){var e;return"proxy"===this.key&&!!(null==(e=this.namespaceOptions.fetch.options.proxy)?void 0:e.url)}}class er extends et{constructor(){super(...arguments),this.namespace="auth"}grantToken(e={},t=":version/auth/grant"){var r,n,i,o;return r=this,n=void 0,i=void 0,o=function*(){try{let r=this.getRequestUrl(t),n=JSON.stringify(e);return{result:yield this.post(r,n,{headers:{"Content-Type":"application/json"}}).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}},new(i||(i=Promise))(function(e,t){function s(e){try{u(o.next(e))}catch(e){t(e)}}function a(e){try{u(o.throw(e))}catch(e){t(e)}}function u(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(e){e(r)})).then(s,a)}u((o=o.apply(r,n||[])).next())})}}let en="undefined"!=typeof WebSocket;class es extends K{constructor(e){super(e),this.conn=null,this.sendBuffer=[],this.reconnect=G;let{key:t,websocket:{options:r,client:n}}=this.namespaceOptions;this.proxy?this.baseUrl=r.proxy.url:this.baseUrl=r.url,n?this.transport=n:this.transport=null,r._nodeOnlyHeaders?this.headers=r._nodeOnlyHeaders:this.headers={},"Authorization"in this.headers||(this.accessToken?this.headers.Authorization=`Bearer ${this.accessToken}`:this.headers.Authorization=`Token ${t}`)}connect(e,t){if(this.conn)return;this.reconnect=(r=e)=>{this.connect(r,t)};let n=this.getRequestUrl(t,{},e),s=this.accessToken,i=this.key;if(!s&&!i)throw Error("No key or access token provided for WebSocket connection.");if(this.transport){this.conn=new this.transport(n,void 0,{headers:this.headers}),this.setupConnection();return}if(k())return void Promise.resolve().then(r.bind(r,96402)).then(({default:e})=>{this.conn=new e(n,{headers:this.headers}),console.log("Using WS package"),this.setupConnection()});if(en){this.conn=new WebSocket(n,s?["bearer",s]:["token",i]),this.setupConnection();return}this.conn=new ei(n,void 0,{close:()=>{this.conn=null}}),Promise.resolve().then(r.bind(r,96402)).then(({default:e})=>{this.conn=new e(n,void 0,{headers:this.headers}),this.setupConnection()})}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null)}connectionState(){switch(this.conn&&this.conn.readyState){case l.connecting:return c.Connecting;case l.open:return c.Open;case l.closing:return c.Closing;default:return c.Closed}}getReadyState(){var e,t;return null!=(t=null==(e=this.conn)?void 0:e.readyState)?t:l.closed}isConnected(){return this.connectionState()===c.Open}send(e){let t=()=>{var t,r,n,s;return t=this,r=void 0,n=void 0,s=function*(){var t;if(e instanceof Blob){if(0===e.size)return void this.log("warn","skipping `send` for zero-byte blob",e);e=yield e.arrayBuffer()}if("string"!=typeof e&&!(null==e?void 0:e.byteLength))return void this.log("warn","skipping `send` for zero-byte payload",e);null==(t=this.conn)||t.send(e)},new(n||(n=Promise))(function(e,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(o,a)}u((s=s.apply(t,r||[])).next())})};this.isConnected()?t():this.sendBuffer.push(t)}get proxy(){var e;return"proxy"===this.key&&!!(null==(e=this.namespaceOptions.websocket.options.proxy)?void 0:e.url)}extractErrorInformation(e,t){var r;let n={};if(t&&(n.readyState=t.readyState,n.url="string"==typeof t.url?t.url:null==(r=t.url)?void 0:r.toString()),t&&"object"==typeof t){if(t._req&&t._req.res&&(n.statusCode=t._req.res.statusCode,t._req.res.headers)){n.responseHeaders=Object.assign({},t._req.res.headers);let e=t._req.res.headers["dg-request-id"]||t._req.res.headers["x-dg-request-id"];e&&(n.requestId=e)}if(e&&"target"in e&&e.target){let t=e.target;t.url&&(n.url=t.url),void 0!==t.readyState&&(n.readyState=t.readyState)}}return n}createEnhancedError(e,t){let r=new u(e.message||"WebSocket connection error",Object.assign({originalEvent:e},t));return Object.assign(Object.assign({},e),{error:r,statusCode:t.statusCode,requestId:t.requestId,responseHeaders:t.responseHeaders,url:t.url,readyState:t.readyState,message:this.buildEnhancedErrorMessage(e,t)})}buildEnhancedErrorMessage(e,t){let r=e.message||"WebSocket connection error",n=[];if(t.statusCode&&n.push(`Status: ${t.statusCode}`),t.requestId&&n.push(`Request ID: ${t.requestId}`),void 0!==t.readyState){let e=["CONNECTING","OPEN","CLOSING","CLOSED"][t.readyState]||`Unknown(${t.readyState})`;n.push(`Ready State: ${e}`)}return t.url&&n.push(`URL: ${t.url}`),n.length>0&&(r+=` (${n.join(", ")})`),r}setupConnectionEvents(e){this.conn&&(this.conn.onopen=()=>{this.emit(e.Open,this)},this.conn.onclose=t=>{this.emit(e.Close,t)},this.conn.onerror=t=>{let r=this.extractErrorInformation(t,this.conn||void 0),n=this.createEnhancedError(t,r);this.emit(e.Error,n)})}}class ei{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=l.connecting,this.send=()=>{},this.url=null,this.url=e.toString(),this.close=r.close}}!function(e){e.Open="open",e.Close="close",e.Error="error",e.Transcript="Results",e.Metadata="Metadata",e.UtteranceEnd="UtteranceEnd",e.SpeechStarted="SpeechStarted",e.Unhandled="Unhandled"}(h||(h={}));class eo extends es{constructor(e,t={},r=":version/listen"){var s,i;if(super(e),this.namespace="listen",(null==(s=t.keyterm)?void 0:s.length)&&!(null==(i=t.model)?void 0:i.startsWith("nova-3")))throw new n("Keyterms are only supported with the Nova 3 models.");this.connect(t,r)}setupConnection(){this.setupConnectionEvents({Open:h.Open,Close:h.Close,Error:h.Error}),this.conn&&(this.conn.onmessage=e=>{var t,r,n,s;try{let t=JSON.parse(e.data.toString());t.type===h.Metadata?this.emit(h.Metadata,t):t.type===h.Transcript?this.emit(h.Transcript,t):t.type===h.UtteranceEnd?this.emit(h.UtteranceEnd,t):t.type===h.SpeechStarted?this.emit(h.SpeechStarted,t):this.emit(h.Unhandled,t)}catch(i){this.emit(h.Error,{event:e,message:"Unable to parse `data` as JSON.",error:i,url:null==(t=this.conn)?void 0:t.url,readyState:null==(r=this.conn)?void 0:r.readyState,data:(null==(n=e.data)?void 0:n.toString().substring(0,200))+((null==(s=e.data)?void 0:s.toString().length)>200?"...":"")})}})}configure(e){this.send(JSON.stringify({type:"Configure",processors:e}))}keepAlive(){this.send(JSON.stringify({type:"KeepAlive"}))}finalize(){this.send(JSON.stringify({type:"Finalize"}))}finish(){this.requestClose()}requestClose(){this.send(JSON.stringify({type:"CloseStream"}))}}var ea=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};class eu extends et{constructor(){super(...arguments),this.namespace="listen"}transcribeUrl(e,t,r=":version/listen"){var i,o;return ea(this,void 0,void 0,function*(){try{let s;if(D(e))s=JSON.stringify(e);else throw new n("Unknown transcription source type");if(void 0!==t&&"callback"in t)throw new n("Callback cannot be provided as an option to a synchronous transcription. Use `transcribeUrlCallback` or `transcribeFileCallback` instead.");if((null==(i=null==t?void 0:t.keyterm)?void 0:i.length)&&!(null==(o=t.model)?void 0:o.startsWith("nova-3")))throw new n("Keyterms are only supported with the Nova 3 models.");let a=this.getRequestUrl(r,{},Object.assign({},t));return{result:yield this.post(a,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}transcribeFile(e,t,r=":version/listen"){return ea(this,void 0,void 0,function*(){try{let s;if(T(e))s=e;else throw new n("Unknown transcription source type");if(void 0!==t&&"callback"in t)throw new n("Callback cannot be provided as an option to a synchronous transcription. Use `transcribeUrlCallback` or `transcribeFileCallback` instead.");let i=this.getRequestUrl(r,{},Object.assign({},t));return{result:yield this.post(i,s,{headers:{"Content-Type":"deepgram/audio+video"}}).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}transcribeUrlCallback(e,t,r,i=":version/listen"){return ea(this,void 0,void 0,function*(){try{let s;if(D(e))s=JSON.stringify(e);else throw new n("Unknown transcription source type");let o=this.getRequestUrl(i,{},Object.assign(Object.assign({},r),{callback:t.toString()}));return{result:yield this.post(o,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}transcribeFileCallback(e,t,r,i=":version/listen"){return ea(this,void 0,void 0,function*(){try{let s;if(T(e))s=e;else throw new n("Unknown transcription source type");let o=this.getRequestUrl(i,{},Object.assign(Object.assign({},r),{callback:t.toString()}));return{result:yield this.post(o,s,{headers:{"Content-Type":"deepgram/audio+video"}}).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}}class el extends K{constructor(){super(...arguments),this.namespace="listen"}get prerecorded(){return new eu(this.options)}live(e={},t=":version/listen"){return new eo(this.options,e,t)}}var ec=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};class eh extends et{constructor(){super(...arguments),this.namespace="manage"}getTokenDetails(e=":version/auth/token"){return ec(this,void 0,void 0,function*(){try{let t=this.getRequestUrl(e);return{result:yield this.get(t).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjects(e=":version/projects"){return ec(this,void 0,void 0,function*(){try{let t=this.getRequestUrl(e);return{result:yield this.get(t).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProject(e,t=":version/projects/:projectId"){return ec(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}updateProject(e,t,r=":version/projects/:projectId"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e},t),s=JSON.stringify(t);return{result:yield this.patch(n,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}deleteProject(e,t=":version/projects/:projectId"){return ec(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return yield this.delete(r),{error:null}}catch(e){if(s(e))return{error:e};throw e}})}getProjectKeys(e,t=":version/projects/:projectId/keys"){return ec(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectKey(e,t,r=":version/projects/:projectId/keys/:keyId"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,keyId:t});return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}createProjectKey(e,t,r=":version/projects/:projectId/keys"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e},t),s=JSON.stringify(t);return{result:yield this.post(n,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}deleteProjectKey(e,t,r=":version/projects/:projectId/keys/:keyId"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,keyId:t});return yield this.delete(n),{error:null}}catch(e){if(s(e))return{error:e};throw e}})}getProjectMembers(e,t=":version/projects/:projectId/members"){return ec(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}removeProjectMember(e,t,r=":version/projects/:projectId/members/:memberId"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,memberId:t});return yield this.delete(n),{error:null}}catch(e){if(s(e))return{error:e};throw e}})}getProjectMemberScopes(e,t,r=":version/projects/:projectId/members/:memberId/scopes"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,memberId:t});return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}updateProjectMemberScope(e,t,r,n=":version/projects/:projectId/members/:memberId/scopes"){return ec(this,void 0,void 0,function*(){try{let s=this.getRequestUrl(n,{projectId:e,memberId:t},r),i=JSON.stringify(r);return{result:yield this.put(s,i).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectInvites(e,t=":version/projects/:projectId/invites"){return ec(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}sendProjectInvite(e,t,r=":version/projects/:projectId/invites"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e},t),s=JSON.stringify(t);return{result:yield this.post(n,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}deleteProjectInvite(e,t,r=":version/projects/:projectId/invites/:email"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,email:t});return yield this.delete(n),{error:null}}catch(e){if(s(e))return{error:e};throw e}})}leaveProject(e,t=":version/projects/:projectId/leave"){return ec(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return{result:yield this.delete(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectUsageRequests(e,t,r=":version/projects/:projectId/requests"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e},t);return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectUsageRequest(e,t,r=":version/projects/:projectId/requests/:requestId"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,requestId:t});return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectUsageSummary(e,t,r=":version/projects/:projectId/usage"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e},t);return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectUsageFields(e,t,r=":version/projects/:projectId/usage/fields"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e},t);return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectBalances(e,t=":version/projects/:projectId/balances"){return ec(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getProjectBalance(e,t,r=":version/projects/:projectId/balances/:balanceId"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,balanceId:t});return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getAllModels(e,t={},r=":version/projects/:projectId/models"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e},t);return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getModel(e,t,r=":version/projects/:projectId/models/:modelId"){return ec(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,modelId:t});return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}}var ed=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};class ep extends et{constructor(){super(...arguments),this.namespace="models"}getAll(e=":version/models",t={}){return ed(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(e,{},t);return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getModel(e,t=":version/models/:modelId"){return ed(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{modelId:e});return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}}var ef=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};class eg extends et{constructor(){super(...arguments),this.namespace="selfhosted"}listCredentials(e,t=":version/projects/:projectId/onprem/distribution/credentials"){return ef(this,void 0,void 0,function*(){try{let r=this.getRequestUrl(t,{projectId:e});return{result:yield this.get(r).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}getCredentials(e,t,r=":version/projects/:projectId/onprem/distribution/credentials/:credentialsId"){return ef(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,credentialsId:t});return{result:yield this.get(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}createCredentials(e,t,r=":version/projects/:projectId/onprem/distribution/credentials"){return ef(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e}),s=JSON.stringify(t);return{result:yield this.post(n,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}deleteCredentials(e,t,r=":version/projects/:projectId/onprem/distribution/credentials/:credentialsId"){return ef(this,void 0,void 0,function*(){try{let n=this.getRequestUrl(r,{projectId:e,credentialsId:t});return{result:yield this.delete(n).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}}var ev=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};class ey extends et{constructor(){super(...arguments),this.namespace="read"}analyzeUrl(e,t,r=":version/read"){return ev(this,void 0,void 0,function*(){try{let s;if(D(e))s=JSON.stringify(e);else throw new n("Unknown source type");if(void 0!==t&&"callback"in t)throw new n("Callback cannot be provided as an option to a synchronous transcription. Use `analyzeUrlCallback` or `analyzeTextCallback` instead.");let i=this.getRequestUrl(r,{},Object.assign({},t));return{result:yield this.post(i,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}analyzeText(e,t,r=":version/read"){return ev(this,void 0,void 0,function*(){try{let s;if(M(e))s=JSON.stringify(e);else throw new n("Unknown source type");if(void 0!==t&&"callback"in t)throw new n("Callback cannot be provided as an option to a synchronous requests. Use `analyzeUrlCallback` or `analyzeTextCallback` instead.");let i=this.getRequestUrl(r,{},Object.assign({},t));return{result:yield this.post(i,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}analyzeUrlCallback(e,t,r,i=":version/read"){return ev(this,void 0,void 0,function*(){try{let s;if(D(e))s=JSON.stringify(e);else throw new n("Unknown source type");let o=this.getRequestUrl(i,{},Object.assign(Object.assign({},r),{callback:t.toString()}));return{result:yield this.post(o,s).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}analyzeTextCallback(e,t,r,i=":version/read"){return ev(this,void 0,void 0,function*(){try{let s;if(M(e))s=JSON.stringify(e);else throw new n("Unknown source type");let o=this.getRequestUrl(i,{},Object.assign(Object.assign({},r),{callback:t.toString()}));return{result:yield this.post(o,s,{headers:{"Content-Type":"deepgram/audio+video"}}).then(e=>e.json()),error:null}}catch(e){if(s(e))return{result:null,error:e};throw e}})}}!function(e){e.Open="Open",e.Close="Close",e.Error="Error",e.Metadata="Metadata",e.Flushed="Flushed",e.Warning="Warning",e.Audio="Audio",e.Unhandled="Unhandled"}(d||(d={}));class em extends es{constructor(e,t={},r=":version/speak"){super(e),this.namespace="speak",this.connect(t,r)}setupConnection(){this.setupConnectionEvents({Open:d.Open,Close:d.Close,Error:d.Error}),this.conn&&(this.conn.onmessage=e=>{this.handleMessage(e)})}handleTextMessage(e){e.type===d.Metadata?this.emit(d.Metadata,e):e.type===d.Flushed?this.emit(d.Flushed,e):e.type===d.Warning?this.emit(d.Warning,e):this.emit(d.Unhandled,e)}handleBinaryMessage(e){this.emit(d.Audio,e)}sendText(e){this.send(JSON.stringify({type:"Speak",text:e}))}flush(){this.send(JSON.stringify({type:"Flush"}))}clear(){this.send(JSON.stringify({type:"Clear"}))}requestClose(){this.send(JSON.stringify({type:"Close"}))}handleMessage(e){var t,r,n,s,i,o;if("string"==typeof e.data)try{let t=JSON.parse(e.data);this.handleTextMessage(t)}catch(i){this.emit(d.Error,{event:e,message:"Unable to parse `data` as JSON.",error:i,url:null==(t=this.conn)?void 0:t.url,readyState:null==(r=this.conn)?void 0:r.readyState,data:(null==(n=e.data)?void 0:n.toString().substring(0,200))+((null==(s=e.data)?void 0:s.toString().length)>200?"...":"")})}else e.data instanceof Blob?e.data.arrayBuffer().then(e=>{this.handleBinaryMessage(Buffer.from(e))}):e.data instanceof ArrayBuffer?this.handleBinaryMessage(Buffer.from(e.data)):Buffer.isBuffer(e.data)?this.handleBinaryMessage(e.data):(console.log("Received unknown data type",e.data),this.emit(d.Error,{event:e,message:"Received unknown data type.",url:null==(i=this.conn)?void 0:i.url,readyState:null==(o=this.conn)?void 0:o.readyState,dataType:typeof e.data}))}}var ew=function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})};class eb extends et{constructor(){super(...arguments),this.namespace="speak"}request(e,t,r=":version/speak"){return ew(this,void 0,void 0,function*(){let s;if(M(e))s=JSON.stringify(e);else throw new n("Unknown transcription source type");let i=this.getRequestUrl(r,{},Object.assign({model:"aura-2-thalia-en"},t));return this.result=yield this.post(i,s,{headers:{Accept:"audio/*","Content-Type":"application/json"}}),this})}getStream(){return ew(this,void 0,void 0,function*(){if(!this.result)throw new o("Tried to get stream before making request","");return this.result.body})}getHeaders(){return ew(this,void 0,void 0,function*(){if(!this.result)throw new o("Tried to get headers before making request","");return this.result.headers})}}class eS extends K{constructor(){super(...arguments),this.namespace="speak"}request(e,t,r=":version/speak"){return new eb(this.options).request(e,t,r)}live(e={},t=":version/speak"){return new em(this.options,e,t)}}!function(e){e.Open="Open",e.Close="Close",e.Error="Error",e.Audio="Audio",e.Welcome="Welcome",e.SettingsApplied="SettingsApplied",e.ConversationText="ConversationText",e.UserStartedSpeaking="UserStartedSpeaking",e.AgentThinking="AgentThinking",e.FunctionCallRequest="FunctionCallRequest",e.AgentStartedSpeaking="AgentStartedSpeaking",e.AgentAudioDone="AgentAudioDone",e.InjectionRefused="InjectionRefused",e.PromptUpdated="PromptUpdated",e.SpeakUpdated="SpeakUpdated",e.Unhandled="Unhandled"}(p||(p={}));class ej extends es{constructor(e,t="/:version/agent/converse"){var r,n,s,i;super(e),this.namespace="agent",this.baseUrl=null!=(i=null==(s=null==(n=null==(r=e.agent)?void 0:r.websocket)?void 0:n.options)?void 0:s.url)?i:F,this.connect({},t)}setupConnection(){this.setupConnectionEvents({Open:p.Open,Close:p.Close,Error:p.Error}),this.conn&&(this.conn.onmessage=e=>{this.handleMessage(e)})}handleMessage(e){var t,r,n,s,i,o;if("string"==typeof e.data)try{let t=JSON.parse(e.data);this.handleTextMessage(t)}catch(i){this.emit(p.Error,{event:e,data:(null==(t=e.data)?void 0:t.toString().substring(0,200))+((null==(r=e.data)?void 0:r.toString().length)>200?"...":""),message:"Unable to parse `data` as JSON.",error:i,url:null==(n=this.conn)?void 0:n.url,readyState:null==(s=this.conn)?void 0:s.readyState})}else e.data instanceof Blob?e.data.arrayBuffer().then(e=>{this.handleBinaryMessage(Buffer.from(e))}):e.data instanceof ArrayBuffer?this.handleBinaryMessage(Buffer.from(e.data)):Buffer.isBuffer(e.data)?this.handleBinaryMessage(e.data):(console.log("Received unknown data type",e.data),this.emit(p.Error,{event:e,message:"Received unknown data type.",url:null==(i=this.conn)?void 0:i.url,readyState:null==(o=this.conn)?void 0:o.readyState,dataType:typeof e.data}))}handleBinaryMessage(e){this.emit(p.Audio,e)}handleTextMessage(e){e.type in p?this.emit(e.type,e):this.emit(p.Unhandled,e)}configure(e){let t=JSON.stringify(Object.assign({type:"Settings"},e));this.send(t)}updatePrompt(e){this.send(JSON.stringify({type:"UpdatePrompt",prompt:e}))}updateSpeak(e){this.send(JSON.stringify({type:"UpdateSpeak",speak:e}))}injectAgentMessage(e){this.send(JSON.stringify({type:"InjectAgentMessage",content:e}))}injectUserMessage(e){this.send(JSON.stringify({type:"InjectUserMessage",content:e}))}functionCallResponse(e){this.send(JSON.stringify(Object.assign({type:"FunctionCallResponse"},e)))}keepAlive(){this.send(JSON.stringify({type:"KeepAlive"}))}}class eC extends K{get auth(){return new er(this.options)}get listen(){return new el(this.options)}get manage(){return new eh(this.options)}get models(){return new ep(this.options)}get onprem(){return this.selfhosted}get selfhosted(){return new eg(this.options)}get read(){return new ey(this.options)}get speak(){return new eS(this.options)}agent(e="/:version/agent/converse"){return new ej(this.options,e)}get transcription(){throw new a}get projects(){throw new a}get keys(){throw new a}get members(){throw new a}get scopes(){throw new a}get invitation(){throw new a}get usage(){throw new a}get billing(){throw new a}}!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(f||(f={}));var eO=r(59406),ek=r.n(eO),e$=r(35075),eU=r.n(e$);function eE(e,t="HH:mm:ss.SSS"){return ek()(1e3*e).utc().format(t)}ek().extend(eU());class ex{constructor(e){this.transcriptionData=e}getLines(e=8){let{results:t}=this.transcriptionData,r=[];if(t.utterances)t.utterances.forEach(t=>{t.words.length>e?r.push(...function(e,t){let r=[];for(let n=0;n<e.length;n+=t){let s=e.slice(n,n+t);r.push(s)}return r}(t.words,e)):r.push(t.words)});else{let n=t.channels[0].alternatives[0].words,s="speaker"in n[0],i=[],o=0;n.forEach(t=>{var n;s&&t.speaker!==o&&(r.push(i),i=[]),i.length===e&&(r.push(i),i=[]),s&&(o=null!=(n=t.speaker)?n:0),i.push(t)}),r.push(i)}return r}getHeaders(){var e,t,r,n,s,i,o,a;let u=[];return u.push("NOTE"),u.push("Transcription provided by Deepgram"),(null==(e=this.transcriptionData.metadata)?void 0:e.request_id)&&u.push(`Request Id: ${null==(t=this.transcriptionData.metadata)?void 0:t.request_id}`),(null==(r=this.transcriptionData.metadata)?void 0:r.created)&&u.push(`Created: ${null==(n=this.transcriptionData.metadata)?void 0:n.created}`),(null==(s=this.transcriptionData.metadata)?void 0:s.duration)&&u.push(`Duration: ${null==(i=this.transcriptionData.metadata)?void 0:i.duration}`),(null==(o=this.transcriptionData.metadata)?void 0:o.channels)&&u.push(`Channels: ${null==(a=this.transcriptionData.metadata)?void 0:a.channels}`),u}}let eD=e=>"transcriptionData"in e?e:new ex(e),eM=(e,t=8)=>{let r=[],n=eD(e);r.push("WEBVTT"),r.push(""),n.getHeaders&&r.push(n.getHeaders().join("\n")),n.getHeaders&&r.push("");let s=n.getLines(t),i="speaker"in s[0][0];return s.forEach(e=>{let t=e[0],n=e[e.length-1];r.push(`${eE(t.start)} --> ${eE(n.end)}`);let s=e.map(e=>{var t;return null!=(t=e.punctuated_word)?t:e.word}).join(" "),o=i?`<v Speaker ${t.speaker}>`:"";r.push(`${o}${s}`),r.push("")}),r.join("\n")},eT=(e,t=8)=>{let r,n=[],s=eD(e).getLines(t),i="speaker"in s[0][0],o=1;return s.forEach(e=>{n.push((o++).toString());let t=e[0],s=e[e.length-1];n.push(`${eE(t.start,"HH:mm:ss,SSS")} --> ${eE(s.end,"HH:mm:ss,SSS")}`);let a=e.map(e=>{var t;return null!=(t=e.punctuated_word)?t:e.word}).join(" "),u=i&&r!==t.speaker?`[Speaker ${t.speaker}]
`:"";n.push(`${u}${a}`),n.push(""),r=t.speaker}),n.join("\n")};class eR{constructor(e,t,r){throw this.apiKey=e,this.apiUrl=t,this.requireSSL=r,new a}}function eI(e,t){let r={};return"string"==typeof e||"function"==typeof e?("object"==typeof t&&(r=t),r.key=e):"object"==typeof e&&(r=e),new eC(r)}},27910:e=>{"use strict";e.exports=require("stream")},28086:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});var n=r(34386),s=r(44999);async function i(){let e=await (0,s.UL)();return(0,n.createServerClient)("https://qrowzznnnarfogfbnnow.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFyb3d6em5ubmFyZm9nZmJubm93Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwNjg1MzUsImV4cCI6MjA2NzY0NDUzNX0.MkCeFSLoOyGl-y1_eZTXTXXV8hGOJM7WuBV7gvLc_rI",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:n})=>e.set(t,r,n))}catch{}}}})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},35075:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,s,i){var o=s.prototype;i.utc=function(e){var t={date:e,utc:!0,args:arguments};return new s(t)},o.utc=function(t){var r=i(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},o.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var a=o.parse;o.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var u=o.init;o.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var l=o.utcOffset;o.utcOffset=function(n,s){var i=this.$utils().u;if(i(n))return this.$u?0:i(this.$offset)?l.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var s=(""+n[0]).match(r)||["-",0,0],i=s[0],o=60*s[1]+ +s[2];return 0===o?0:"+"===i?o:-o}(n)))return this;var o=16>=Math.abs(n)?60*n:n,a=this;if(s)return a.$offset=o,a.$u=0===n,a;if(0!==n){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(o+u,e)).$offset=o,a.$x.$localOffset=u}else a=this.utc();return a};var c=o.format;o.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return c.call(this,t)},o.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var h=o.toDate;o.toDate=function(e){return"s"===e&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var d=o.diff;o.diff=function(e,t,r){if(e&&this.$u===e.$u)return d.call(this,e,t,r);var n=this.local(),s=i(e).local();return d.call(n,s,t,r)}}}()},39727:()=>{},43793:e=>{"use strict";var t=function(e){var t,n,s;return!!(t=e)&&"object"==typeof t&&(n=e,"[object RegExp]"!==(s=Object.prototype.toString.call(n))&&"[object Date]"!==s&&n.$$typeof!==r)},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a(Array.isArray(e)?[]:{},e,t):e}function s(e,t,r){return e.concat(t).map(function(e){return n(e,r)})}function i(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function o(e,t){try{return t in e}catch(e){return!1}}function a(e,r,u){(u=u||{}).arrayMerge=u.arrayMerge||s,u.isMergeableObject=u.isMergeableObject||t,u.cloneUnlessOtherwiseSpecified=n;var l,c,h=Array.isArray(r);return h!==Array.isArray(e)?n(r,u):h?u.arrayMerge(e,r,u):(c={},(l=u).isMergeableObject(e)&&i(e).forEach(function(t){c[t]=n(e[t],l)}),i(r).forEach(function(t){o(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))||(o(e,t)&&l.isMergeableObject(r[t])?c[t]=(function(e,t){if(!t.customMerge)return a;var r=t.customMerge(e);return"function"==typeof r?r:a})(t,l)(e[t],r[t],l):c[t]=n(r[t],l))}),c)}a.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,r){return a(e,r,t)},{})},e.exports=a},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},59406:function(e){e.exports=function(){"use strict";var e="millisecond",t="second",r="minute",n="hour",s="week",i="month",o="quarter",a="year",u="date",l="Invalid Date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},p="en",f={};f[p]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}};var g="$isDayjsObject",v=function(e){return e instanceof b||!(!e||!e[g])},y=function e(t,r,n){var s;if(!t)return p;if("string"==typeof t){var i=t.toLowerCase();f[i]&&(s=i),r&&(f[i]=r,s=i);var o=t.split("-");if(!s&&o.length>1)return e(o[0])}else{var a=t.name;f[a]=t,s=a}return!n&&s&&(p=s),s||!n&&p},m=function(e,t){if(v(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new b(r)},w={s:d,z:function(e){var t=-e.utcOffset(),r=Math.abs(t);return(t<=0?"+":"-")+d(Math.floor(r/60),2,"0")+":"+d(r%60,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),s=t.clone().add(n,i),o=r-s<0,a=t.clone().add(n+(o?-1:1),i);return+(-(n+(r-s)/(o?s-a:a-s))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return({M:i,y:a,w:s,d:"day",D:u,h:n,m:r,s:t,ms:e,Q:o})[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};w.l=y,w.i=v,w.w=function(e,t){return m(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var b=function(){function d(e){this.$L=y(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[g]=!0}var p=d.prototype;return p.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(c);if(n){var s=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],s,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],s,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(t)}(e),this.init()},p.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},p.$utils=function(){return w},p.isValid=function(){return this.$d.toString()!==l},p.isSame=function(e,t){var r=m(e);return this.startOf(t)<=r&&r<=this.endOf(t)},p.isAfter=function(e,t){return m(e)<this.startOf(t)},p.isBefore=function(e,t){return this.endOf(t)<m(e)},p.$g=function(e,t,r){return w.u(e)?this[t]:this.set(r,e)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(e,o){var l=this,c=!!w.u(o)||o,h=w.p(e),d=function(e,t){var r=w.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return c?r:r.endOf("day")},p=function(e,t){return w.w(l.toDate()[e].apply(l.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},f=this.$W,g=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case a:return c?d(1,0):d(31,11);case i:return c?d(1,g):d(0,g+1);case s:var m=this.$locale().weekStart||0,b=(f<m?f+7:f)-m;return d(c?v-b:v+(6-b),g);case"day":case u:return p(y+"Hours",0);case n:return p(y+"Minutes",1);case r:return p(y+"Seconds",2);case t:return p(y+"Milliseconds",3);default:return this.clone()}},p.endOf=function(e){return this.startOf(e,!1)},p.$set=function(s,o){var l,c=w.p(s),h="set"+(this.$u?"UTC":""),d=((l={}).day=h+"Date",l[u]=h+"Date",l[i]=h+"Month",l[a]=h+"FullYear",l[n]=h+"Hours",l[r]=h+"Minutes",l[t]=h+"Seconds",l[e]=h+"Milliseconds",l)[c],p="day"===c?this.$D+(o-this.$W):o;if(c===i||c===a){var f=this.clone().set(u,1);f.$d[d](p),f.init(),this.$d=f.set(u,Math.min(this.$D,f.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},p.set=function(e,t){return this.clone().$set(e,t)},p.get=function(e){return this[w.p(e)]()},p.add=function(e,o){var u,l=this;e=Number(e);var c=w.p(o),h=function(t){var r=m(l);return w.w(r.date(r.date()+Math.round(t*e)),l)};if(c===i)return this.set(i,this.$M+e);if(c===a)return this.set(a,this.$y+e);if("day"===c)return h(1);if(c===s)return h(7);var d=((u={})[r]=6e4,u[n]=36e5,u[t]=1e3,u)[c]||1,p=this.$d.getTime()+e*d;return w.w(p,this)},p.subtract=function(e,t){return this.add(-1*e,t)},p.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||l;var n=e||"YYYY-MM-DDTHH:mm:ssZ",s=w.z(this),i=this.$H,o=this.$m,a=this.$M,u=r.weekdays,c=r.months,d=r.meridiem,p=function(e,r,s,i){return e&&(e[r]||e(t,n))||s[r].slice(0,i)},f=function(e){return w.s(i%12||12,e,"0")},g=d||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(h,function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return w.s(t.$y,4,"0");case"M":return a+1;case"MM":return w.s(a+1,2,"0");case"MMM":return p(r.monthsShort,a,c,3);case"MMMM":return p(c,a);case"D":return t.$D;case"DD":return w.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return p(r.weekdaysMin,t.$W,u,2);case"ddd":return p(r.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(i);case"HH":return w.s(i,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return g(i,o,!0);case"A":return g(i,o,!1);case"m":return String(o);case"mm":return w.s(o,2,"0");case"s":return String(t.$s);case"ss":return w.s(t.$s,2,"0");case"SSS":return w.s(t.$ms,3,"0");case"Z":return s}return null}(e)||s.replace(":","")})},p.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},p.diff=function(e,u,l){var c,h=this,d=w.p(u),p=m(e),f=(p.utcOffset()-this.utcOffset())*6e4,g=this-p,v=function(){return w.m(h,p)};switch(d){case a:c=v()/12;break;case i:c=v();break;case o:c=v()/3;break;case s:c=(g-f)/6048e5;break;case"day":c=(g-f)/864e5;break;case n:c=g/36e5;break;case r:c=g/6e4;break;case t:c=g/1e3;break;default:c=g}return l?c:w.a(c)},p.daysInMonth=function(){return this.endOf(i).$D},p.$locale=function(){return f[this.$L]},p.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=y(e,t,!0);return n&&(r.$L=n),r},p.clone=function(){return w.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},d}(),S=b.prototype;return m.prototype=S,[["$ms",e],["$s",t],["$m",r],["$H",n],["$W","day"],["$M",i],["$y",a],["$D",u]].forEach(function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),m.extend=function(e,t){return e.$i||(e(t,b,m),e.$i=!0),m},m.locale=y,m.isDayjs=v,m.unix=function(e){return m(1e3*e)},m.en=f[p],m.Ls=f,m.p={},m}()},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91272:(e,t,r)=>{let n=r(97294),s=n.default||n,i=function(e,t){return/^\/\//.test(e)&&(e="https:"+e),s.call(this,e,t)};i.ponyfill=!0,e.exports=t=i,t.fetch=i,t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response,t.default=i},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[4447,580,6570,645,4386,4999,7294],()=>r(10081));module.exports=n})();