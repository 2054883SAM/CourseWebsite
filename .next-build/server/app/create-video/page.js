(()=>{var e={};e.id=1737,e.ids=[1737],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31092:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var a=t(60687),s=t(43210),o=t(24524),i=t(92599),n=t(29605),l=t(16189);function d({section:e,sectionIndex:r,onSectionChange:t,onRemoveSection:o,canRemove:i}){let[n,l]=(0,s.useState)({title:"",startTime:0,startTimeFormatted:"00:00",duration:void 0,durationFormatted:"",description:void 0,thumbnail:void 0,flashcard:!1}),d=(0,s.useRef)(null),c=a=>{t(r,{...e,...a})},u=r=>{c({chapters:e.chapters.filter(e=>e.id!==r)})},p=e=>{let r=Math.floor(e/3600),t=Math.floor(e%3600/60),a=Math.floor(e%60);return r>0?`${r}:${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`:`${t}:${a.toString().padStart(2,"0")}`};return(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center",children:[(0,a.jsx)("span",{className:"mr-3",children:"\uD83C\uDFAC"}),"Section ",r+1]}),i&&(0,a.jsx)("button",{type:"button",onClick:()=>o(r),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:"\uD83D\uDDD1️ Supprimer"})]}),"pending"!==e.status&&"completed"!==e.status&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border-l-4 border-blue-500",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"mr-2",children:["uploading"===e.status&&"\uD83D\uDCE4","processing"===e.status&&"⚙️","transcribing"===e.status&&"\uD83C\uDFA4","translating"===e.status&&"\uD83C\uDF0D","error"===e.status&&"❌"]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["Section ",r+1,": ",e.currentStep]})]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:[e.uploadProgress,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-3 dark:bg-blue-800",children:(0,a.jsx)("div",{className:`h-3 rounded-full transition-all duration-300 ${"error"===e.status?"bg-red-500":"bg-gradient-to-r from-blue-500 to-blue-600"}`,style:{width:`${e.uploadProgress}%`}})}),e.error&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:["Erreur: ",e.error]})]}),"completed"===e.status&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border-l-4 border-green-500",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"✅"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:["Section ",r+1," termin\xe9e avec succ\xe8s"]})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Titre de la section *"}),(0,a.jsx)("input",{type:"text",value:e.title,onChange:e=>{c({title:e.target.value})},required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-200",placeholder:`Ex: Introduction - Partie ${r+1}`})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Vid\xe9o de la section *"}),(0,a.jsx)("input",{type:"file",ref:d,onChange:e=>{let t=e.target.files?.[0];t&&(c({videoFile:t}),console.log(`Section ${r} - Vid\xe9o s\xe9lectionn\xe9e:`,t.name,"Taille:",t.size))},accept:"video/*",required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-200"}),e.videoFile&&(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:["Vid\xe9o s\xe9lectionn\xe9e: ",e.videoFile.name," (",(e.videoFile.size/1024/1024).toFixed(2)," MB)"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl dark:border-gray-700",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.aiGeneratedChapters,onChange:e=>{c({aiGeneratedChapters:e.target.checked})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"G\xe9n\xe9rer les chapitres automatiquement avec l'IA"})]}),e.aiGeneratedChapters&&(0,a.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Les chapitres seront g\xe9n\xe9r\xe9s \xe0 partir de la transcription."})]}),e.chapters.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:["Chapitres (",e.chapters.length,")"]}),(0,a.jsx)("div",{className:"border rounded-xl overflow-hidden dark:border-gray-700",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Titre"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"D\xe9but"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Dur\xe9e"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Description"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-900 dark:divide-gray-700",children:e.chapters.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.title}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:p(e.startTime)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.duration?p(e.duration):"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.description||"-"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>u(e.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Supprimer"})})]},e.id))})]})})]})]})]})}var c=t(30474);function u(){let{user:e,dbUser:r,loading:t}=(0,i.As)(),u=(0,l.useRouter)(),p=(0,n.createBrowserClient)("https://qrowzznnnarfogfbnnow.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFyb3d6em5ubmFyZm9nZmJubm93Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwNjg1MzUsImV4cCI6MjA2NzY0NDUzNX0.MkCeFSLoOyGl-y1_eZTXTXXV8hGOJM7WuBV7gvLc_rI"),[m,x]=(0,s.useState)({title:"",description:"",isFeatured:!1,aiGenerated:!1,thumbnailUrl:"",thumbnailDescription:"",primary_language:"fr",ceQueVousAllezApprendre:"",dureeEstimee:""}),[g,h]=(0,s.useState)(!1),[b,f]=(0,s.useState)(0),[y,v]=(0,s.useState)(null),[j,w]=(0,s.useState)(""),[N,k]=(0,s.useState)([{id:crypto.randomUUID(),title:"",videoFile:null,aiGeneratedChapters:!1,chapters:[],uploadProgress:0,status:"pending",currentStep:"En attente"}]),[C,S]=(0,s.useState)(0);(0,s.useRef)(null);let I=(0,s.useRef)(null),E=e=>{console.log("Success:",e),alert(e)},P=e=>{console.error("Error:",e),alert("Erreur: "+e)};if(t)return(0,a.jsx)(o.Mx,{children:(0,a.jsx)(o.wn,{className:"py-8",children:(0,a.jsx)(o.mc,{children:(0,a.jsx)("div",{className:"flex min-h-[400px] items-center justify-center",children:(0,a.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-b-2 border-t-2 border-blue-600"})})})})});if(!e||!r)return(0,a.jsx)(o.Mx,{children:(0,a.jsx)(o.wn,{className:"py-8",children:(0,a.jsx)(o.mc,{children:(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"mb-2 text-xl font-semibold text-gray-700 dark:text-gray-300",children:"Non authentifi\xe9"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Veuillez vous connecter pour cr\xe9er un cours."})]})})})});if(!["admin","teacher"].includes(r.role))return(0,a.jsx)(o.Mx,{children:(0,a.jsx)(o.wn,{className:"py-8",children:(0,a.jsx)(o.mc,{children:(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"mb-2 text-xl font-semibold text-gray-700 dark:text-gray-300",children:"Acc\xe8s non autoris\xe9"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Seuls les administrateurs et les enseignants peuvent cr\xe9er des cours."}),(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-500",children:["Votre r\xf4le actuel: ",r.role]})]})})})});let D=e=>{let{name:r,value:t,type:a}=e.target,s=e.target.checked;x(e=>({...e,[r]:"checkbox"===a?s:t}))},O=e=>{N.length>1&&k(r=>r.filter((r,t)=>t!==e))},A=(e,r)=>{k(t=>t.map((t,a)=>a===e?r:t))},U=async(e,r,t)=>{try{console.log("VDOCIPHER: Requesting upload credentials..."),t(10);let a=await fetch("/api/upload-video/vdocipher-credentials",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r?.trim()||"Untitled video",folderId:"root"})});if(!a.ok){let e=await a.text();throw Error(`Credentials request failed: ${a.status} - ${e}`)}let{clientPayload:s,videoId:o}=await a.json();console.log("VDOCIPHER: Upload credentials received",{videoId:o}),t(25),console.log("VDOCIPHER: Uploading file to VdoCipher...");let i=new FormData;i.append("file",e),i.append("uploadCredentials",JSON.stringify(s));let n=await fetch("/api/upload-video/vdocipher-upload",{method:"POST",body:i});if(!n.ok){let e=await n.text();throw Error(`Upload failed: ${n.status} - ${e}`)}try{await n.json()}catch(e){}console.log("VDOCIPHER: Upload completed"),t(50),console.log("VDOCIPHER: Monitoring processing status (up to ~10 minutes)...");let l=!1,d=0,c=Date.now();for(;!l&&d<60;){d++;let e=((Date.now()-c)/6e4).toFixed(1),r=50+d/60*40;t(r),d>1&&await new Promise(e=>setTimeout(e,1e4));let a=await fetch(`/api/upload-video/vdocipher-status?videoId=${o}`,{method:"GET"});if(!a.ok){let e=await a.text();console.warn("VDOCIPHER: Status check failed",{status:a.status,error:e});continue}let s=await a.json();if(console.log("VDOCIPHER: Status check",{attempt:d,...s,elapsedMinutes:e}),s.isReady)l=!0,console.log(`VDOCIPHER: Video is ready after ${e} minutes`);else if("Error"===s.status||"Failed"===s.status)throw Error(`Video processing failed with status: ${s.status}`)}if(!l){let e=((Date.now()-c)/6e4).toFixed(1);console.warn(`VDOCIPHER: Video still processing after ${e} minutes. Proceeding with course creation; processing continues in background.`)}return t(100),o}catch(e){throw console.error("VDOCIPHER: Upload error",e),e}},T=async t=>{if(console.log("Starting thumbnail upload for file:",t.name,"Size:",t.size),!t.type.startsWith("image/"))throw Error("Le fichier doit \xeatre une image");if(t.size>5242880)throw Error("L'image doit faire moins de 5MB");let a=t.name.split(".").pop(),s=`${Math.random()}.${a}`,o=`course-thumbnails/${s}`;console.log("Uploading to path:",o),console.log("User role:",r?.role),console.log("User ID:",e?.id);let{data:i,error:n}=await p.storage.from("course-thumbnails").upload(o,t);if(n)throw console.error("Upload error details:",n),Error(`Erreur lors de l'upload de la thumbnail: ${n.message}`);console.log("Upload successful:",i);let{data:{publicUrl:l}}=p.storage.from("course-thumbnails").getPublicUrl(o);return console.log("Generated public URL:",l),l},M=(e,r)=>{k(t=>t.map((t,a)=>a===e?{...t,...r}:t))},R=async e=>new Promise(r=>{try{let t=URL.createObjectURL(e),a=document.createElement("video");a.preload="metadata",a.onloadedmetadata=()=>{let e=a.duration;if(URL.revokeObjectURL(t),!isNaN(e)&&isFinite(e)&&e>0){let t=Math.max(1,Math.round(e/60));console.log("LOCAL DURATION: Extracted from file",{seconds:e,minutes:t}),r(t)}else r(1)},a.onerror=()=>{URL.revokeObjectURL(t),r(1)},a.src=t}catch(e){console.warn("LOCAL DURATION: Error extracting duration from file",e),r(1)}}),q=async(e,r,t)=>{if(!e.videoFile)throw Error("Aucun fichier vid\xe9o s\xe9lectionn\xe9");try{let t=await R(e.videoFile);console.log("DURATION: Local file analysis result",{minutes:t}),M(r,{status:"uploading",currentStep:"Upload de la vid\xe9o...",uploadProgress:0});let a=await U(e.videoFile,e.title,e=>{M(r,{uploadProgress:Math.round(.4*e),currentStep:`Upload de la vid\xe9o... ${Math.round(e)}%`})});M(r,{playbackId:a,status:"processing",currentStep:"Vid\xe9o upload\xe9e, obtention de la dur\xe9e...",uploadProgress:40});let s=t;if(1===t)try{let e=await fetch(`/api/upload-video/vdocipher-status?videoId=${a}`,{method:"GET"});if(e.ok){let r=await e.json();"number"==typeof r.duration&&r.duration>0&&(s=Math.max(1,Math.round(r.duration/60)),console.log("DURATION: Got duration from VdoCipher",{seconds:r.duration,minutes:s}))}}catch(e){console.warn("DURATION: Could not get duration from VdoCipher, using local duration",e)}console.log("DURATION: Final duration for section",{minutes:s,source:t>1?"local":"vdocipher"}),M(r,{currentStep:"Dur\xe9e obtenue, g\xe9n\xe9ration des sous-titres...",uploadProgress:45}),M(r,{status:"transcribing",currentStep:"G\xe9n\xe9ration des sous-titres...",uploadProgress:50});let o="temp_"+crypto.randomUUID(),i=e.id,n=new FormData;n.append("file",e.videoFile),n.append("format","vtt"),n.append("language",m.primary_language),n.append("courseId",o),n.append("sectionId",i),n.append("videoId",a);let l=await fetch("/api/upload-video/deepgram-captions",{method:"POST",body:n});if(!l.ok){let e=await l.text();throw Error(`Erreur lors de la g\xe9n\xe9ration des sous-titres: ${e}`)}let d=await l.json();console.log("CAPTIONS: Generated for section",i),M(r,{currentStep:"Sous-titres g\xe9n\xe9r\xe9s...",uploadProgress:65});let c=e.chapters;if(e.aiGeneratedChapters&&d?.captions){M(r,{currentStep:"G\xe9n\xe9ration des chapitres IA...",uploadProgress:70});try{let t=await fetch("/api/upload-video/generate-chapters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({captions:String(d.captions),language:m.primary_language})});if(t.ok){let{chapters:a}=await t.json();Array.isArray(a)&&(c=a.map(e=>({id:crypto.randomUUID(),title:String(e.title||"").trim(),startTime:Math.max(0,Math.floor(Number(e.startTime)||0)),duration:null!=e.duration?Math.max(1,Math.floor(Number(e.duration))):void 0,description:null!=e.description?String(e.description):void 0,flashcard:"boolean"==typeof e.flashcard&&e.flashcard})),M(r,{chapters:c}),console.log("CHAPTERS: AI chapters generated for section",e.title))}}catch(e){console.warn("CHAPTERS: Error during AI generation",e)}}M(r,{currentStep:"Chapitres trait\xe9s...",uploadProgress:80}),M(r,{status:"translating",currentStep:"Traduction des sous-titres...",uploadProgress:85});try{(await fetch("/api/upload-video/translate-and-upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({courseId:o,sectionId:i,videoId:a,sourceLanguage:m.primary_language})})).ok&&console.log("CAPTIONS: Translation completed for section",e.title)}catch(e){console.warn("CAPTIONS: Error in translate/upload step",e)}return M(r,{status:"completed",currentStep:"Section termin\xe9e",uploadProgress:100}),{playbackId:a,chapters:c,duration:s}}catch(e){throw M(r,{status:"error",currentStep:"Erreur",uploadProgress:0,error:e instanceof Error?e.message:"Erreur inconnue"}),e}},$=async r=>{if(r.preventDefault(),!e)return;let t=N.filter(e=>e.title.trim()&&e.videoFile);if(0===t.length)return void P("Au moins une section avec un titre et une vid\xe9o est requise");h(!0),f(0);try{let r=m.thumbnailUrl;y&&(f(5),r=await T(y),f(10)),console.log(`Starting processing of ${t.length} sections...`);let a=[],s=80/t.length;for(let e=0;e<t.length;e++){let r=t[e],o=N.findIndex(e=>e.id===r.id);console.log(`Processing section ${e+1}/${t.length}: ${r.title}`);try{let i=await q(r,o,t.length);a.push({originalSection:r,...i});let n=10+(e+1)*s;f(Math.round(n))}catch(e){throw console.error(`Error processing section ${r.title}:`,e),P(`Erreur lors du traitement de la section "${r.title}": ${e instanceof Error?e.message:"Erreur inconnue"}`),e}}console.log("All sections processed successfully. Creating course..."),f(90);let o={title:m.title,description:m.description,thumbnail_url:r||null,creator_id:e.id,is_featured:m.isFeatured,ce_que_vous_allez_apprendre:m.ceQueVousAllezApprendre||null},{data:i,error:n}=await p.from("courses").insert(o).select().single();if(n)throw console.error("Course insert error details:",n),Error("Erreur lors de la cr\xe9ation du cours");console.log("Course created:",i.id),f(95);let l=a.map((e,r)=>{let t=e.duration&&e.duration>0?e.duration:1;return console.log(`SECTION INSERT: Section ${r+1} - Duration: ${t} minutes (original: ${e.duration})`),{course_id:i.id,title:e.originalSection.title,section_number:r+1,playback_id:e.playbackId,chapters:e.chapters.length>0?JSON.stringify(e.chapters):"[]",duration:t}}),{data:d,error:c}=await p.from("sections").insert(l).select();if(c)throw console.error("Sections insert error:",c),Error("Erreur lors de la cr\xe9ation des sections");console.log(`Created ${d.length} sections in database`);try{console.log("Attempting to move captions from temp sectionIds to DB sectionIds...");for(let e=0;e<a.length;e++){let r=a[e].originalSection.id,t=d[e];if(!t?.id)continue;let s=`${r}/captions.vtt`,o=`${t.id}/captions.vtt`;if(s===o)continue;let{data:i,error:n}=await p.storage.from("translations").move(s,o);n?console.warn("CAPTIONS MOVE: Failed to move captions",{fromPath:s,toPath:o,error:n.message}):console.log("CAPTIONS MOVE: Moved captions",{fromPath:s,toPath:o,result:i})}}catch(e){console.warn("CAPTIONS MOVE: Error while moving captions to DB section ids",e)}try{console.log("QUESTIONS: Generating mixed questions for each section...");for(let e=0;e<d.length;e++){let r=d[e];if(r?.id)try{let e=await fetch("/api/video/generate-questions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sectionId:r.id,maxQuestions:8})});if(!e.ok){console.warn("QUESTIONS: Generation failed for section",r.id,await e.text());continue}let t=await e.json(),a=Array.isArray(t?.questions)?t.questions:[],s={questions:a.length>0?JSON.stringify(a.slice(0,8)):"[]"},{error:o}=await p.from("sections").update(s).eq("id",r.id);o?console.warn("QUESTIONS: Failed to save questions",{sectionId:r.id,error:o.message}):console.log("QUESTIONS: Saved questions for section",r.id)}catch(e){console.warn("QUESTIONS: Error generating/saving questions for section",r?.id,e)}}}catch(e){console.warn("QUESTIONS: Batch generation encountered an error",e)}f(100),E(`Cours cr\xe9\xe9 avec succ\xe8s ! ${t.length} section(s) ont \xe9t\xe9 upload\xe9es sur VdoCipher et seront bient\xf4t disponibles.`),u.push("/courses"),x({title:"",description:"",isFeatured:!1,aiGenerated:!1,thumbnailUrl:"",thumbnailDescription:"",primary_language:"fr",ceQueVousAllezApprendre:"",dureeEstimee:""}),v(null),w(""),k([{id:crypto.randomUUID(),title:"",videoFile:null,aiGeneratedChapters:!1,chapters:[],uploadProgress:0,status:"pending",currentStep:"En attente"}]),S(0)}catch(e){console.error("Erreur lors de la cr\xe9ation du cours:",e),P("Erreur lors de la cr\xe9ation du cours: "+(e instanceof Error?e.message:"Erreur inconnue"))}finally{h(!1),f(0)}};return(0,a.jsx)(o.Mx,{children:(0,a.jsx)(o.wn,{className:"bg-gradient-to-br from-blue-50 via-white to-purple-50 py-8 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,a.jsx)(o.mc,{children:(0,a.jsxs)("div",{className:"mx-auto max-w-4xl",children:[(0,a.jsxs)("div",{className:"mb-12 text-center",children:[(0,a.jsx)("h1",{className:"mb-4 text-4xl font-bold text-gray-900 dark:text-white",children:"Cr\xe9er un nouveau cours"}),(0,a.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Partagez vos connaissances avec le monde en cr\xe9ant un cours vid\xe9o interactif"})]}),g&&(0,a.jsxs)("div",{className:"mb-8 rounded-2xl bg-white p-6 shadow-lg dark:bg-gray-800",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cr\xe9ation du cours en cours..."}),(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:[b,"%"]})]}),(0,a.jsx)("div",{className:"h-3 w-full rounded-full bg-gray-200 dark:bg-gray-700",children:(0,a.jsx)("div",{className:"h-3 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300",style:{width:`${b}%`}})}),(0,a.jsx)("div",{className:"mt-4 grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-3",children:N.filter(e=>e.title.trim()&&e.videoFile).map((e,r)=>(0,a.jsxs)("div",{className:`flex items-center rounded border p-2 text-xs ${"completed"===e.status?"border-green-200 bg-green-50 text-green-700 dark:border-green-800 dark:bg-green-900/20 dark:text-green-300":"error"===e.status?"border-red-200 bg-red-50 text-red-700 dark:border-red-800 dark:bg-red-900/20 dark:text-red-300":"pending"===e.status?"border-gray-200 bg-gray-50 text-gray-600 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400":"border-blue-200 bg-blue-50 text-blue-700 dark:border-blue-800 dark:bg-blue-900/20 dark:text-blue-300"}`,children:[(0,a.jsxs)("div",{className:"mr-2",children:["pending"===e.status&&"⏳","uploading"===e.status&&"\uD83D\uDCE4","processing"===e.status&&"⚙️","transcribing"===e.status&&"\uD83C\uDFA4","translating"===e.status&&"\uD83C\uDF0D","completed"===e.status&&"✅","error"===e.status&&"❌"]}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsxs)("div",{className:"truncate font-medium",children:["Section ",r+1]}),(0,a.jsx)("div",{className:"truncate text-xs opacity-75",children:e.currentStep})]}),"pending"!==e.status&&"completed"!==e.status&&(0,a.jsxs)("div",{className:"ml-2 text-xs font-medium",children:[e.uploadProgress,"%"]})]},e.id))}),C>0&&C<100&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Traduction des sous-titres..."}),(0,a.jsxs)("span",{className:"text-xs text-purple-600 dark:text-purple-400",children:[C,"%"]})]}),(0,a.jsx)("div",{className:"h-1 w-full rounded-full bg-gray-200 dark:bg-gray-700",children:(0,a.jsx)("div",{className:"h-1 rounded-full bg-purple-500 transition-all duration-300",style:{width:`${C}%`}})})]})]}),(0,a.jsxs)("form",{onSubmit:$,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"rounded-2xl bg-white p-8 shadow-lg dark:bg-gray-800",children:[(0,a.jsxs)("h2",{className:"mb-6 flex items-center text-2xl font-bold text-gray-900 dark:text-white",children:[(0,a.jsx)("span",{className:"mr-3",children:"\uD83D\uDCDD"}),"Informations de base"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Titre du cours *"}),(0,a.jsx)("input",{type:"text",name:"title",value:m.title,onChange:D,required:!0,className:"w-full rounded-xl border border-gray-300 px-4 py-3 transition-all duration-200 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Ex: Introduction \xe0 React"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description *"}),(0,a.jsx)("textarea",{name:"description",value:m.description,onChange:D,required:!0,rows:4,className:"w-full rounded-xl border border-gray-300 px-4 py-3 transition-all duration-200 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"D\xe9crivez votre cours..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Langue principale du cours *"}),(0,a.jsxs)("select",{name:"primary_language",value:m.primary_language,onChange:D,className:"w-full rounded-xl border border-gray-300 px-4 py-3 transition-all duration-200 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",children:[(0,a.jsx)("option",{value:"fr",children:"Fran\xe7ais"}),(0,a.jsx)("option",{value:"en",children:"Anglais"}),(0,a.jsx)("option",{value:"es",children:"Espagnol"})]})]}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",name:"isFeatured",checked:m.isFeatured,onChange:D,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 dark:border-gray-600"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Mettre en vedette ce cours"})]})})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl bg-white p-8 shadow-lg dark:bg-gray-800",children:[(0,a.jsxs)("h2",{className:"mb-6 flex items-center text-2xl font-bold text-gray-900 dark:text-white",children:[(0,a.jsx)("span",{className:"mr-3",children:"\uD83D\uDCCB"}),"Informations d\xe9taill\xe9es"]}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Ce que vous allez apprendre"}),(0,a.jsx)("textarea",{name:"ceQueVousAllezApprendre",value:m.ceQueVousAllezApprendre,onChange:D,rows:3,className:"w-full rounded-xl border border-gray-300 px-4 py-3 transition-all duration-200 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"Listez les comp\xe9tences que les \xe9tudiants acquerront..."})]})})]}),(0,a.jsxs)("div",{className:"rounded-2xl bg-white p-8 shadow-lg dark:bg-gray-800",children:[(0,a.jsxs)("h2",{className:"mb-6 flex items-center text-2xl font-bold text-gray-900 dark:text-white",children:[(0,a.jsx)("span",{className:"mr-3",children:"\uD83D\uDDBC️"}),"Image de couverture"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"URL de l'image"}),(0,a.jsx)("input",{type:"url",name:"thumbnailUrl",value:m.thumbnailUrl,onChange:D,className:"w-full rounded-xl border border-gray-300 px-4 py-3 transition-all duration-200 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"https://example.com/image.jpg"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Ou t\xe9l\xe9charger une image"}),(0,a.jsx)("input",{type:"file",ref:I,onChange:e=>{let r=e.target.files?.[0];if(r){v(r);let e=new FileReader;e.onload=e=>{w(e.target?.result)},e.readAsDataURL(r)}},accept:"image/*",className:"w-full rounded-xl border border-gray-300 px-4 py-3 transition-all duration-200 focus:border-transparent focus:ring-2 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),j&&(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Aper\xe7u"}),(0,a.jsx)("div",{className:"relative w-full max-w-md",children:(0,a.jsx)(c.default,{src:j,alt:"Aper\xe7u de la thumbnail",width:400,height:200,className:"h-48 w-full rounded-xl border border-gray-300 object-cover dark:border-gray-600"})})]})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl bg-white p-8 shadow-lg dark:bg-gray-800",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"flex items-center text-2xl font-bold text-gray-900 dark:text-white",children:[(0,a.jsx)("span",{className:"mr-3",children:"\uD83C\uDFAC"}),"Sections du cours"]}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e={id:crypto.randomUUID(),title:"",videoFile:null,aiGeneratedChapters:!1,chapters:[],uploadProgress:0,status:"pending",currentStep:"En attente"};k(r=>[...r,e])},className:"rounded-lg bg-green-600 px-4 py-2 font-medium text-white transition-colors duration-200 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:"➕ Ajouter une section"})]}),(0,a.jsx)("div",{className:"space-y-6",children:N.map((e,r)=>(0,a.jsx)(d,{section:e,sectionIndex:r,onSectionChange:A,onRemoveSection:O,canRemove:N.length>1},e.id))})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("button",{type:"submit",disabled:g,className:"inline-flex transform items-center rounded-full bg-gradient-to-r from-blue-600 to-purple-600 px-8 py-4 font-semibold text-white shadow-lg transition-all duration-300 hover:scale-105 hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"-ml-1 mr-3 h-5 w-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Cr\xe9ation en cours..."]}):"Cr\xe9er le cours"})})]})]})})})})}},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},46055:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});var a=t(31658);let s=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},47260:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=t(65239),s=t(48088),o=t(88170),i=t.n(o),n=t(30893),l={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(r,l);let d={children:["",{children:["create-video",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,54222)),"C:\\Users\\Konan\\Documents\\MONSPACE\\CourseWebsite-1\\app\\create-video\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,58014)),"C:\\Users\\Konan\\Documents\\MONSPACE\\CourseWebsite-1\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\Konan\\Documents\\MONSPACE\\CourseWebsite-1\\app\\create-video\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/create-video/page",pathname:"/create-video",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},51992:(e,r,t)=>{Promise.resolve().then(t.bind(t,54222))},54222:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Konan\\\\Documents\\\\MONSPACE\\\\CourseWebsite-1\\\\app\\\\create-video\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Konan\\Documents\\MONSPACE\\CourseWebsite-1\\app\\create-video\\page.tsx","default")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},86840:(e,r,t)=>{Promise.resolve().then(t.bind(t,31092))},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[4447,9278,1658,9605,9679],()=>t(47260));module.exports=a})();