(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{2039:(e,r,t)=>{Promise.resolve().then(t.bind(t,1477)),Promise.resolve().then(t.bind(t,3125)),Promise.resolve().then(t.t.bind(t,6874,23))},3125:(e,r,t)=>{"use strict";t.d(r,{default:()=>x});var a=t(5155),s=t(2115),o=t(3107),l=t(3579),i=t(6766),n=t(7650);let d=e=>{let{message:r,type:t,duration:o=5e3,onClose:l}=e,[i,d]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{d(!0);let e=setTimeout(()=>{d(!1),setTimeout(l,300)},o);return()=>clearTimeout(e)},[o,l]),(0,n.createPortal)((0,a.jsx)("div",{className:"".concat((()=>{let e="fixed top-4 right-4 z-50 max-w-sm w-full bg-white dark:bg-gray-800 rounded-xl shadow-lg border-l-4 transform transition-all duration-300";switch(t){case"success":return"".concat(e," border-green-500");case"error":return"".concat(e," border-red-500");case"warning":return"".concat(e," border-yellow-500");case"info":return"".concat(e," border-blue-500");default:return"".concat(e," border-gray-500")}})()," ").concat(i?"translate-x-0 opacity-100":"translate-x-full opacity-0"),children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex-shrink-0 mr-3 text-xl",children:(()=>{switch(t){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";case"info":return"ℹ️";default:return"\uD83D\uDCAC"}})()}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(()=>{switch(t){case"success":return"Succ\xe8s";case"error":return"Erreur";case"warning":return"Attention";case"info":return"Information";default:return"Notification"}})()}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-300",children:r})]}),(0,a.jsx)("button",{onClick:()=>{d(!1),setTimeout(l,300)},className:"flex-shrink-0 ml-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}),document.body)},c=e=>{let{toasts:r,onRemove:t}=e;return(0,a.jsx)(a.Fragment,{children:r.map((e,r)=>(0,a.jsx)(d,{message:e.message,type:e.type,duration:e.duration,onClose:()=>t(e.id)},e.id))})},u=()=>{let[e,r]=(0,s.useState)([]),t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2?arguments[2]:void 0,s=Math.random().toString(36).substr(2,9);r(r=>[...r,{id:s,message:e,type:t,duration:a}])};return{toasts:e,addToast:t,removeToast:e=>{r(r=>r.filter(r=>r.id!==e))},success:(e,r)=>t(e,"success",r),error:(e,r)=>t(e,"error",r),warning:(e,r)=>t(e,"warning",r),info:(e,r)=>t(e,"info",r)}};function x(){var e,r;let{user:t,dbUser:n,loading:d}=(0,o.As)(),[x,m]=(0,s.useState)((null==n?void 0:n.name)||""),[h,p]=(0,s.useState)((null==n?void 0:n.bio)||""),[g,f]=(0,s.useState)(!1),[b,y]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),[w,k]=(0,s.useState)(!1),N=(0,s.useRef)(null),C=(0,l.createClientComponentClient)(),{toasts:E,success:z,error:S,removeToast:D}=u();if(d)return(0,a.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"})});if(!t||!n)return(0,a.jsxs)("div",{className:"text-center p-8",children:[(0,a.jsx)("div",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Non authentifi\xe9"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Veuillez vous connecter pour voir votre profil."})]});let L=async e=>{try{var r,t;let a=null==(r=e.target.files)?void 0:r[0];if(!a)return;if(a.size>5242880)return void S("La taille du fichier doit \xeatre inf\xe9rieure \xe0 5MB");if(!a.type.startsWith("image/"))return void S("Veuillez s\xe9lectionner un fichier image valide");y(!0);let{data:s}=await C.auth.getUser(),o=null==(t=s.user)?void 0:t.id;if(!o)throw Error("Vous devez \xeatre connect\xe9 pour t\xe9l\xe9charger une photo");let l=a.name.split(".").pop(),i="".concat(o,"-").concat(Date.now(),".").concat(l),n="".concat(o,"/").concat(i);console.log("Using auth ID for upload:",o),console.log("Upload path:",n);let{error:d}=await C.storage.from("profile-picture").upload(n,a,{cacheControl:"3600",upsert:!0});if(d)throw console.error("Upload error:",d),Error("Erreur lors de l&apos;upload de la photo");let{data:{publicUrl:c}}=C.storage.from("profile-picture").getPublicUrl(n),{error:u}=await C.from("users").update({photo_url:c}).eq("id",o);if(u)throw console.error("Update error:",u),Error("Erreur lors de la mise \xe0 jour du profil");z("Photo de profil mise \xe0 jour avec succ\xe8s !"),setTimeout(()=>{window.location.reload()},1e3)}catch(e){console.error("Error uploading photo:",e),S("\xc9chec de l&apos;upload de la photo: "+(e instanceof Error?e.message:"Erreur inconnue"))}finally{y(!1)}},M=async()=>{try{j(!0),k(!1);let{error:e}=await C.from("users").update({photo_url:null}).eq("id",t.id);if(e)throw console.error("Update error:",e),Error("Erreur lors de la suppression de la photo");z("Photo de profil supprim\xe9e avec succ\xe8s !"),setTimeout(()=>{window.location.reload()},1e3)}catch(e){console.error("Error deleting photo:",e),S("\xc9chec de la suppression de la photo: "+(e instanceof Error?e.message:"Erreur inconnue"))}finally{j(!1)}},P=async e=>{e.preventDefault();try{f(!0);let{error:e}=await C.from("users").update({name:x,bio:h}).eq("id",t.id);if(e)throw console.error("Update error:",e),Error("Erreur lors de la mise \xe0 jour du profil");z("Profil mis \xe0 jour avec succ\xe8s !")}catch(e){console.error("Error updating profile:",e),S("\xc9chec de la mise \xe0 jour du profil: "+(e instanceof Error?e.message:"Erreur inconnue"))}finally{f(!1)}};return(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Param\xe8tres du profil"}),(0,a.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"G\xe9rez vos informations personnelles et votre photo de profil"})]}),(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center",children:[(0,a.jsx)("span",{className:"mr-3",children:"\uD83D\uDCF8"}),"Photo de profil"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsx)("div",{className:"relative",children:n.photo_url?(0,a.jsxs)("div",{className:"relative w-32 h-32 group",children:[(0,a.jsx)(i.default,{src:n.photo_url,alt:"Photo de profil de ".concat(n.name),width:128,height:128,className:"rounded-full object-cover border-4 border-gray-200 dark:border-gray-600"}),(0,a.jsxs)("div",{className:"absolute inset-0 rounded-full bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-200 flex items-center justify-center",children:[(0,a.jsx)("button",{type:"button",onClick:()=>k(!0),disabled:v,className:"absolute top-2 right-2 h-8 w-8 rounded-full bg-red-500 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-200 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Supprimer la photo de profil",children:(0,a.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("span",{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-sm font-medium",children:"Modifier"})]})]}):(0,a.jsx)("div",{className:"w-32 h-32 bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900 dark:to-purple-900 rounded-full flex items-center justify-center border-4 border-gray-200 dark:border-gray-600",children:(0,a.jsx)("span",{className:"text-4xl text-gray-500 dark:text-gray-400 font-bold",children:(null==(r=n.name)||null==(e=r[0])?void 0:e.toUpperCase())||"?"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:n.name||"Utilisateur"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:n.photo_url?'Cliquez sur "Modifier la photo" pour changer votre image de profil, ou survolez la photo pour la supprimer.':"Ajoutez une photo de profil pour personnaliser votre compte."}),(0,a.jsx)("input",{type:"file",ref:N,onChange:L,accept:"image/*",className:"hidden"}),(0,a.jsx)("button",{type:"button",onClick:()=>{var e;return null==(e=N.current)?void 0:e.click()},disabled:b,className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-full shadow-lg hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105",children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Upload en cours..."]}):(0,a.jsxs)(a.Fragment,{children:["\uD83D\uDCF7 ",n.photo_url?"Modifier la photo":"Ajouter une photo"]})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Formats accept\xe9s: JPG, PNG, GIF. Taille max: 5MB"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center",children:[(0,a.jsx)("span",{className:"mr-3",children:"\uD83D\uDC64"}),"Informations personnelles"]}),(0,a.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nom complet *"}),(0,a.jsx)("input",{type:"text",value:x,onChange:e=>{m(e.target.value)},className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-200",disabled:g,required:!0,minLength:2,maxLength:50,placeholder:"Votre nom complet"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Adresse email"}),(0,a.jsx)("input",{type:"email",value:n.email||"",disabled:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-xl bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 cursor-not-allowed",placeholder:"email@exemple.com"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"L'email ne peut pas \xeatre modifi\xe9"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"R\xf4le"}),(0,a.jsx)("div",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400",children:(0,a.jsx)("span",{className:"capitalize",children:n.role})}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Votre r\xf4le dans la plateforme"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date d'inscription"}),(0,a.jsx)("div",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl bg-gray-50 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400",children:n.created_at?new Date(n.created_at).toLocaleDateString("fr-FR"):"N/A"})]})]}),(0,a.jsxs)("div",{className:"col-span-full",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Bio / Description"}),(0,a.jsx)("textarea",{value:h,onChange:e=>{p(e.target.value)},className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white transition-all duration-200 resize-none",disabled:g,rows:4,maxLength:500,placeholder:"Parlez-nous de vous... (votre expertise, vos passions, vos objectifs)"}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"D\xe9crivez-vous en quelques mots pour personnaliser votre profil"}),(0,a.jsxs)("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:[h.length,"/500"]})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-6",children:(0,a.jsx)("button",{type:"submit",disabled:g,className:"inline-flex items-center px-8 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white font-semibold rounded-full shadow-lg hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sauvegarde..."]}):"\uD83D\uDCBE Sauvegarder les modifications"})})]})]})]}),w&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/20 mb-4",children:(0,a.jsx)("svg",{className:"h-8 w-8 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Supprimer la photo de profil ?"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"\xcates-vous s\xfbr de vouloir supprimer votre photo de profil ? Cette action ne peut pas \xeatre annul\xe9e."}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>k(!1),disabled:v,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Annuler"}),(0,a.jsx)("button",{type:"button",onClick:M,disabled:v,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Suppression..."]}):"Supprimer"})]})]})})}),(0,a.jsx)(c,{toasts:E,onRemove:D})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[5647,6874,6766,4077,8415,8441,1684,7358],()=>r(2039)),_N_E=e.O()}]);