(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8179],{5695:(e,r,t)=>{"use strict";var s=t(8999);t.o(s,"useParams")&&t.d(r,{useParams:function(){return s.useParams}}),t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}})},6455:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(5155),a=t(6874),n=t.n(a),o=t(2115),i=t(5695);function l(){let[e,r]=(0,o.useState)(!0),[t,a]=(0,o.useState)(null),[l,c]=(0,o.useState)(!1),u=(0,i.useRouter)(),d=(0,i.useSearchParams)();return(0,o.useEffect)(()=>{let e=!1;return(async()=>{try{let e=await fetch("/api/stripe/confirm",{method:"POST"});if(!e.ok){let r=await e.json().catch(()=>({}));throw Error((null==r?void 0:r.error)||"Failed to confirm membership")}let r=null==d?void 0:d.get("courseId");if(r){c(!0);let e=await fetch("/api/enrollments/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({courseId:r})}),t=await e.json().catch(()=>({}));if((!e.ok||!(null==t?void 0:t.success))&&!(null==t?void 0:t.alreadyEnrolled))throw Error((null==t?void 0:t.error)||"Failed to enroll in course");u.replace("/courses/".concat(r));return}}catch(r){e||a((null==r?void 0:r.message)||"Failed to confirm membership")}finally{e||r(!1),e||c(!1)}})(),()=>{e=!0}},[u,d]),(0,s.jsxs)("div",{className:"mx-auto max-w-3xl px-6 py-16 text-center",children:[(0,s.jsx)("div",{className:"mx-auto mb-6 h-12 w-12 rounded-full bg-green-100 p-3",children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-6 w-6 text-green-600",children:(0,s.jsx)("path",{d:"M5 13l4 4L19 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,s.jsx)("h1",{className:"text-3xl font-semibold",children:"Paiement r\xe9ussi"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Votre abonnement est actif. Profitez d'un acc\xe8s illimit\xe9 \xe0 tous les cours."}),e&&(0,s.jsx)("p",{className:"mt-4 text-sm text-gray-500",children:"Activation de votre abonnement…"}),l&&(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Inscription au cours…"}),t&&(0,s.jsx)("p",{className:"mt-4 text-sm text-red-600",children:t}),(0,s.jsxs)("div",{className:"mt-8 flex items-center justify-center gap-3",children:[(0,s.jsx)(n(),{href:"/",className:"rounded-md border border-gray-300 px-4 py-2 text-gray-700 hover:bg-gray-50",children:"Accueil"}),(0,s.jsx)(n(),{href:"/my-learning",className:"rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700",children:"Commencer \xe0 apprendre"})]})]})}function c(){return(0,s.jsx)(o.Suspense,{fallback:(0,s.jsx)("div",{className:"mx-auto max-w-3xl px-6 py-16 text-center",children:"Chargement…"}),children:(0,s.jsx)(l,{})})}},9922:(e,r,t)=>{Promise.resolve().then(t.bind(t,6455))}},e=>{var r=r=>e(e.s=r);e.O(0,[6874,8441,1684,7358],()=>r(9922)),_N_E=e.O()}]);